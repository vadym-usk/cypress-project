name: Run Cypress in Docker

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  cypress-tests:
    runs-on: ubuntu-latest

    steps:
      # üß± –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
      - name: Checkout code
        uses: actions/checkout@v4

      # üîß –°–æ–±–∏—Ä–∞–µ–º Docker image
      - name: Build Docker Image
        run: docker build -t cypress-tests .

      # üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
      - name: Run Cypress Tests in Docker
        run: |
          docker run --name cypress-runner \
            -v ${{ github.workspace }}/cypress-reports:/app/cypress/reports \
            cypress-tests

      # üìé –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç—á—ë—Ç –∫–∞–∫ artifact
      - name: Upload HTML Report
        uses: actions/upload-artifact@v4
        with:
          name: cypress-report
          path: cypress-reports/index.html
